<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Zarządzanie Zadaniami</title>
  </head>
  <body>

    <div id="app">
      <div class="centered-text margin-bottom-small">
        <h1>Zarządzanie Zadaniami</h1>
      </div>
      
      <div class="kontener1 centered-text text-white">
        <label>Dodaj nową listę zadań: ‎ </label>
        <input v-model="newListName" @keyup.enter="addTaskList" />
        <button @click="addTaskList">Dodaj</button>
      </div>
    
      <div>
        <h2 class="text-white">Twoje listy zadań:</h2>
        <ul>
          <li v-for="(list, index) in taskLists" :key="index">
            {{ list.name }}
            <button @click="removeTaskList(index)">Usuń</button>
            <div class="margin-bottom-small">
              <label>Dodaj nowe zadanie: </label>
              <input v-model="newTask.title" placeholder="Tytuł" />
              <textarea v-model="newTask.description" placeholder="Opis"></textarea>
              <select v-model="newTask.status">
                <option value="not-done">Niezrobione</option>
                <option value="in-progress">W toku</option>
                <option value="completed">Zakończone</option>
              </select>
              <button @click="addTask(index)">Dodaj</button>
            </div>
            <ul>
              <li class="task" v-for="(task, taskIndex) in list.tasks" :key="taskIndex">
                <span v-if="taskIndex !== editingTaskIndex">
                  <strong>{{ task.title }}</strong>
                  <p>{{ task.description }}</p>
                  <p>Status: {{ task.status }}</p>
                  <button @click="startEditingTask(index, taskIndex)">Edytuj</button>
                  <button @click="removeTask(index, taskIndex)">Usuń</button>
                </span>
                <span v-else>
                  <input v-model="editedTask.title" placeholder="Tytuł" />
                  <textarea v-model="editedTask.description" placeholder="Opis"></textarea>
                  <select v-model="editedTask.status">
                    <option value="not-done">Niezrobione</option>
                    <option value="in-progress">W toku</option>
                    <option value="completed">Zakończone</option>
                  </select>
                  <button @click="saveEditedTask(index, taskIndex)">Zapisz</button>
                  <button @click="cancelEditingTask">Anuluj</button>
                </span>
              </li>
            </ul>
          </li>
        </ul>
      </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/vue@3"></script>
    <script>
      const app = Vue.createApp({
        data() {
          return {
            newListName: '',
            newTask: { title: '', description: '', status: 'not-done' },
            taskLists: [],
            editingTaskIndex: null,
            editedTask: { title: '', description: '', status: '' },
          };
        },
        methods: {
          addTaskList() {
            if (this.newListName.trim() !== '') {
              this.taskLists.push({
                name: this.newListName,
                tasks: [],
              });
              this.newListName = '';
            }
          },
          removeTaskList(index) {
            this.taskLists.splice(index, 1);
          },
          addTask(listIndex) {
            if (this.newTask.title.trim() !== '') {
              this.taskLists[listIndex].tasks.push({
                title: this.newTask.title,
                description: this.newTask.description,
                status: this.newTask.status,
              });
              this.newTask = { title: '', description: '', status: 'not-done' };
            }
          },
          removeTask(listIndex, taskIndex) {
            this.taskLists[listIndex].tasks.splice(taskIndex, 1);
          },
          startEditingTask(listIndex, taskIndex) {
            this.editingTaskIndex = taskIndex;
            this.editedTask.title = this.taskLists[listIndex].tasks[taskIndex].title;
            this.editedTask.description = this.taskLists[listIndex].tasks[taskIndex].description;
            this.editedTask.status = this.taskLists[listIndex].tasks[taskIndex].status;
          },
          saveEditedTask(listIndex, taskIndex) {
            this.taskLists[listIndex].tasks[taskIndex].title = this.editedTask.title;
            this.taskLists[listIndex].tasks[taskIndex].description = this.editedTask.description;
            this.taskLists[listIndex].tasks[taskIndex].status = this.editedTask.status;
            this.cancelEditingTask();
          },
          cancelEditingTask() {
            this.editingTaskIndex = null;
            this.editedTask = { title: '', description: '', status: '' };
          },
        },
      });
    
      app.mount('#app');
    </script>
    
    </body>
</html>
